const circle=document.querySelector(".progress-ring__circle-line"),radius=circle.r.baseVal.value,circumference=2*Math.PI*radius;function setProgress(e){const t=circumference-e/100*circumference;circle.style.strokeDashoffset=t}circle.style.strokeDasharray=`${circumference} ${circumference}`,circle.style.strokeDashoffset=circumference;const circleBody=document.querySelector(".progress-ring__circle"),mediaQuery=window.matchMedia("(max-width: 450px)");function handleTabletChange(e){e.matches&&(circleBody.setAttribute("r","130"),circleBody.setAttribute("cx","145"),circleBody.setAttribute("cy","145"),circle.setAttribute("r","115"),circle.setAttribute("cx","145"),circle.setAttribute("cy","145"))}mediaQuery.addEventListener("onchange",handleTabletChange),handleTabletChange(mediaQuery);const focusTimeInput=document.querySelector("#focusTime"),shortBreakInput=document.querySelector("#shortBreak"),longBreakInput=document.querySelector("#longBreak"),submitForm=document.querySelector("form"),applyButton=document.querySelector(".settings__apply-btn"),closeBtn=document.querySelector("#closeBtn"),fontButtons=document.querySelectorAll(".fonts__item"),settingsOpen=document.querySelector(".timer__icon"),settingsPage=document.querySelector(".page__settings"),changeValueDown=e=>{let t=e.target.closest(".block-control__input").querySelector(".block-control__input-form"),o=parseInt(t.value),c=parseInt(t.min),n=o-parseInt(t.step);t.value=n>=c?n:c},changeValueUp=e=>{let t=e.target.closest(".block-control__input").querySelector(".block-control__input-form"),o=parseInt(t.value),c=parseInt(t.max),n=parseInt(t.step);console.log(t);let s=o+n;t.value=s<=c?s:c},downButton=document.querySelectorAll(".down");downButton.forEach((e=>{e.addEventListener("click",changeValueDown)}));const upButton=document.querySelectorAll(".up");function timeSection(e){e.target.closest(".settings__close")?settingsPage.classList.remove("_active"):e.target.closest(".settings__apply-btn")&&(settingsPage.classList.remove("_active"),setProgress(0),changeClasses(),document.title="Pomodoro timer",clearTimeout(initial),TIMER=makeUser(`${focusTimeInput.value}`,`${shortBreakInput.value}`,`${longBreakInput.value}`),localStorage.setItem("items",JSON.stringify(TIMER)),saveSelectedFont(),saveSelectedColor(),getNewData(),datasetMode())}function getNewData(){if(null===localStorage.getItem("fontColor"))localStorage.setItem("fontColor",JSON.stringify("#F87070"));else{var e=JSON.parse(localStorage.getItem("fontColor"));root.style.setProperty("--mainColor",`${e}`)}if(null===localStorage.getItem("fontFamily"))localStorage.setItem("fontFamily",JSON.stringify("KumbhSans"));else{const e=JSON.parse(localStorage.getItem("fontFamily"));document.body.style.fontFamily=e}null===localStorage.getItem("selected")&&fontItem[0].click(),null===localStorage.getItem("selectedColor")&&(colorItem[0].click(),colorIcons[0].click()),JSON.parse(localStorage.getItem("items"))}upButton.forEach((e=>{e.addEventListener("click",changeValueUp)})),settingsOpen.addEventListener("click",(function(){settingsPage.classList.toggle("_active")})),submitForm.addEventListener("submit",(function(e){e.preventDefault(),localStorage.getItem("items")})),document.addEventListener("click",timeSection);const fontItem=document.querySelectorAll(".fonts__item"),fontBlock=document.querySelector(".setting__fonts");let stored=localStorage.getItem("selected")||"[]",indexes=JSON.parse(stored);for(const e of indexes)fontItem[e].classList.add("_active");function saveSelectedFont(){const e=[];for(let t=0;t<fontItem.length;t++)fontItem[t].classList.contains("_active")&&e.push(t);localStorage.setItem("selected",JSON.stringify(e))}fontItem.forEach((function(e){e.addEventListener("click",(function(){fontItem.forEach((function(e){e.classList.remove("_active")})),e.classList.add("_active");const t=[];for(let e=0;e<fontItem.length;e++)fontItem[e].classList.contains("_active")&&t.push(e)}))})),fontBlock.addEventListener("click",(function(e){e.target.closest("[data-family=KumbhSans]")?localStorage.setItem("fontFamily",JSON.stringify("KumbhSans")):e.target.closest("[data-family=RobotoSlab]")?localStorage.setItem("fontFamily",JSON.stringify("RobotoSlab")):e.target.closest("[data-family=SpaceMono]")&&localStorage.setItem("fontFamily",JSON.stringify("SpaceMono"))}));const colorItem=document.querySelectorAll(".color__item"),colorBlock=document.querySelector(".setting__color"),colorIcons=document.querySelectorAll(".color-icon");let storedColor=localStorage.getItem("selectedColor")||"[]",indexesColor=JSON.parse(storedColor);for(const e of indexesColor)colorIcons[e].classList.add("_icon-check-btn");function saveSelectedColor(){const e=[];for(let t=0;t<colorIcons.length;t++)colorIcons[t].classList.contains("_icon-check-btn")&&e.push(t);console.log(e),localStorage.setItem("selectedColor",JSON.stringify(e))}console.log(colorIcons),colorItem.forEach((function(e){e.addEventListener("click",(function(){colorIcons.forEach((e=>{e.addEventListener("click",(function(){colorIcons.forEach((function(e){e.classList.remove("_icon-check-btn")})),e.classList.add("_icon-check-btn");const t=[];for(let e=0;e<colorIcons.length;e++)colorIcons[e].classList.contains("_icon-check-btn")&&t.push(e)}))}))}))}));const root=document.documentElement;colorBlock.addEventListener("click",(function(e){e.target.closest("[data-color=pink]")?localStorage.setItem("fontColor",JSON.stringify("#F87070")):e.target.closest("[data-color=blue]")?localStorage.setItem("fontColor",JSON.stringify("#70F3F8")):e.target.closest("[data-color=purple]")&&localStorage.setItem("fontColor",JSON.stringify("#D881F8"))})),window.onload=getNewData;const modeButtons=document.querySelector("[class=control]"),timer=document.getElementById("timer"),pomodorButton=document.getElementById("pomodoroButton"),shortButton=document.getElementById("shortButton"),longButton=document.getElementById("longButton"),startBtn=document.querySelector(".start"),pauseBtn=document.querySelector(".pause"),restartBtn=document.querySelector(".restart"),bell=document.querySelector("audio");var interval=null;let paused,initial,seconds=0;var TIMER=JSON.parse(localStorage.getItem("items"))?JSON.parse(localStorage.getItem("items")):makeUser(`${focusTimeInput.value}`,`${shortBreakInput.value}`,`${longBreakInput.value}`);function makeUser(e,t,o){return{POMODORO:e,SHORTBREAK:t,LONGBREAK:o}}function changeMode(e){setProgress(0),changeClasses(),document.title="Pomodoro timer",clearTimeout(initial);for(let t=0;t<3;t++)e.path[1].children[t].classList.remove("_active");e.target.classList.add("_active");let t=e.target.dataset.mode;timer.dataset.mode=t,"pomodoro"===timer.dataset.mode?TIMER.POMODORO<10?timer.innerHTML=`0${TIMER.POMODORO}:00`:timer.innerHTML=`${TIMER.POMODORO}:00`:"short"===timer.dataset.mode?timer.innerHTML=`0${TIMER.SHORTBREAK}:00`:TIMER.LONGBREAK<10?timer.innerHTML=`0${TIMER.LONGBREAK}:00`:timer.innerHTML=`${TIMER.LONGBREAK}:00`,setTimer()}function datasetMode(){"pomodoro"===timer.dataset.mode?TIMER.POMODORO<10?timer.innerHTML=`0${TIMER.POMODORO}:00`:timer.innerHTML=`${TIMER.POMODORO}:00`:"short"===timer.dataset.mode?timer.innerHTML=`0${TIMER.SHORTBREAK}:00`:TIMER.LONGBREAK<10?timer.innerHTML=`0${TIMER.LONGBREAK}:00`:timer.innerHTML=`${TIMER.LONGBREAK}:00`}function setTimer(){"pomodoro"===timer.dataset.mode?(seconds=60*TIMER.POMODORO,totalsecs=60*TIMER.POMODORO):"short"===timer.dataset.mode?(seconds=60*TIMER.SHORTBREAK,totalsecs=60*TIMER.SHORTBREAK):"long"===timer.dataset.mode&&(seconds=60*TIMER.LONGBREAK,totalsecs=60*TIMER.LONGBREAK)}function pomodoroStart(){let e=("0"+Math.floor(seconds/60)).slice(-2)+":"+("0"+seconds%60).slice(-2);timer.innerHTML=e,document.title=`${e} - ${"pomodoro"===timer.dataset.mode?"Work":"Break"}`,startBtn.classList.contains("_active")&&(startBtn.classList.remove("_active"),pauseBtn.classList.add("_active")),seconds>0?(perc=Math.ceil((totalsecs-seconds)/totalsecs*100),setProgress(perc),seconds--,initial=window.setTimeout("pomodoroStart()",1e3)):(seconds=0,bell.play(),pauseBtn.classList.remove("_active"),restartBtn.classList.add("_active"))}function changeClasses(){if(!startBtn.classList.contains("_active")){const e=document.querySelectorAll(".button");for(const t of e)t.classList.remove("_active");startBtn.classList.add("_active")}}function pomodoroPause(){void 0!==paused&&(paused?(paused=!1,initial=setTimeout(pomodoroStart(),60),pauseBtn.textContent="PAUSE"):(clearTimeout(initial),pauseBtn.textContent="start-t",paused=!0))}function pomodoroRestart(){paused=!1,clearTimeout(initial),setProgress(0),localStorage.clear(),restartBtn.classList.contains("_active")&&(restartBtn.classList.remove("_active"),startBtn.classList.add("_active"))}startBtn.addEventListener("click",(()=>{pomodoroStart(),paused=!1})),pauseBtn.addEventListener("click",(()=>{pomodoroPause()})),restartBtn.addEventListener("click",(()=>{pomodoroRestart()})),modeButtons.addEventListener("click",changeMode),pomodorButton.click();